#Improving Clump finding algorithm, right now, no idea what the first one meant so here i am in the next stage
def main():
    genome_string = 'GACATGGGATACAAGGGTTCGCGTCAGGCCGAATGTGGTATTGCACTGAAGATCTGCCTTAATTCTACGAGGGAGGTGTTCGAATGCACAGGATCATACGGACGTCGGATTTTGGCAGCCAACAGAAAAGGGATCTTTTAACCGGTGCTTGCGAGGCTGGAAGTTCTGGCACCCGCTTCCCTTGCATATATATCCTCGTACTAAGAACCTCGGTGGGCACTCGAACCTCGTGGCATTTCCTCAAGTTGACGAAAAAGCCCAGTTATATATACTCAAGTTGACCTCAAGTTGACGCGTCTCAAGTTGACGCCCCCGAGAAGATAGAGAAGATAGGTTGACGTTGCCGAGAAGATAGTGACGCGCCACATCTCAACCGAGAAGATAGCGTCTCAAGTTGACGGTTGACCCGAGAAGATAGTAGGGACCGAGAAGATAGAGAAGATAGCCGAGCCGAGAAGATAGGAGAAGATAGATCTCACCGTCCCCGAGAAGATACCGAGAAGATCCGAGAAGACCGAGAAGATAGCTCAAGTTGACGCTGATGCTACTCAAGTTGACGTCTCAAGTTGACGCCTTAGACCCGAGAAGATAGAAGATAGCTTGCGGGGTCGCGCAAAGTCGGCTCCGAGAAGATAGAAAGTGCTACCGAGAAGATAGAAGTTGACGGTTGACGTGACGACAACCGAGAAGATAGGCTCAAGTTGACGTTGCCGAGCCGAGAAGATAGGGGGACTATCGCCTCAAGTTGACGTATTGAAGCCCATTCTGTTAAAAAGATAGGTCATTCTGTTAAATCGGCTCCATTCTGTTAAATCTGGGTTGTGACATTCTGTCGGTTGTGAGGTCATTCTGTTAAAACCATTCTGTTAAATCTGTTAAAGTGACCATTCTGTTAAATTCATTCTGTTAAACGGTTGTGACATCATTCTGTTAACATTCCATTCTGCATTCTGTTAAATTTCACTGGTCATTCTGTTAAATTGTGACATTGAGGGCACCCCGATGGTTGTGACGGTTGTGACATTACACATTCTGTTAAAACGGTTGTGACACATTCTGTTAAAATCTGTTAAAGACATTTCGGCATGAAATTCATTCTGTTAAAACATTATCTCGTCCATTCTGTTAAAGACATTTGTGGCCTAATAATGTGGTTCATTCTGTTAAACGTTATAGTACTCATTCTGTTCATTCTGTTAAAGCATTCTGTTAAATATAGCAAATTACGGGTTGCATTCTGTTAAACAGGTTGTGACATTGTCGGGTGGTCATTCTGTTAAATTTGAGTCGGTTGTGACATCATTCTGTTAAAACCCGGGATGTGACTGGCATTCTGTTAAATCTGTTAAACTTAGAAGCTTAGATTCATTGTCCCAGCAGAATCAACAACATCCGTATTTGACCAGAGGCTCGTACCAGCAAGCAGAATCAACTAAAATCTAAGCAGAATCAACCTTATCATTTTAGTGACTGTTATTACGCACAGCAGAGCAGAATCAACAGCAGAATCAACAAGATCTGTGTAGCAGAATCAACGCTATTATATTGTTCATTAGCAGCCCTCTTGCATACTGAGCAGAATCAACCTGAGAACAACCAAGCAGAAGCAGAATCAACCCTAACCGCAGCAGAATCAACAGTCGCTAGAGCAGAATCAACAGCAGAATCAACGCAATGTAGCAGAATCAACCAACGCAGAATCAACTCAACAACACAGCGCGTCCTGCCAATGTGCAAAAGCAGCAGAATCAACTTAAACTCAATCTCTAAGTTATGTTTGTACTGGTAGTTGTTAGAAGACGTCTTGGCTAGAGTAAGTGAGTGCTAAAAGCAGAATCAACTCTGTCTCAATGCAAGCAGAATCAACAGAATCAACAACAGGGTCAGCAGAATCAACCCAGCAGAGCAGAATCAACAATCAACGGACAGATCATGAGCAGAATCAACATCAACATGATTAGTTCATATGAAGCTAATCGCGGCATCTTATGGAAATCTATCTCAGTAATGGGATCCGCTCCGCCTTAGACGAAAAGGCGGTCTCGGTAGTGGAAATCTCGCGCACATCTATGTAATGTCGTAACGCGCATCCGGCTAGTGTATTAAATCCAACGCGCATCCGGCTTACGCGCATCCGGTCTTCTCGTCCTCCATCCAATTAATATGGGCGGTACGCGCATCCGGGGCACGCGCATCCGGGCGCATCCGGCACTTCGAACTTAACGAGATGACGCGCATCCGGAAAATTATACGCGCATCCGGCCGGCGGCAATATTCTAAATGAACGCGCATCCGGGCACGACGCGCATCCGGAAAAGCGACAACGCGCATCCGGACACGCGACGCGCATCCGGAGAGGACGATAGTCCAACGCGCATCCGGACGCGCATCCGGACGCGCATCCGGTACGCGCATCCGGTAAAGATAGGGTACGCGCATCCGGGCATACGCGCATCCGGATATACTCACGACGCGCATCCGGAATATACGACGCGCATCCGGATATTCTAAACGCGCATCCGGACTCTACGCGCATCCGGAACGCGCATCCGGAATATTCTAAATTCTAAACCTACGTTATCAATATTCTAAAACGCGCATCCGGTCCGGACGCGCATCCGGACTCTAGAAGGAAGGAACAGGCTAGGCTATCCAGGAAACAACGCGCATCCGGATGTGATACAATCCAATATTCTCAATATTCTAAAGGAACAGGCTACTGATATAGGAACAGGCTACTATTTGAAGGAGGAACAGGCTAGAAGAGGAACACAATATTCTAAATCTAAATATTCTCAATATTCTAAACCCCTGACGGAAAGGAACAGGCTAAGGAACAGGCTACGTTAAACGTATGGTTAAACGTATGGTGGATGAAGGATTAAACGTATGGTAATATTCGTGTGATATAAGGAACAGGCTAGCTAATATTTAAACGTATGGGAACAGGCTAGGAACAGGCTAATACTCTTTAAACGTATGGGTTATTAAACGTATGGGGCTAAGTGACGAGGAAGGAACAGGCTAGATATAGGAACAGGTTAAACGTATGGTTAAACGTATGGATCACACTTAAACGTATGGCGAATTAAACGTATGGGAAACTCAGGAGTTAAACGTATGGTATGTTAAACGTATGGGAATTAAACGTATGTTAAACGTATGGAAGGAACAGGCTTTAAACGTTTTTAAACGTATGGCCACAGATGTACCAAGCTCGCTCACCGTTTAGCGTTAAATTAAACGTATGGTTTTAAACGTATGGGTATGGTATGGTGCCCCTTAAACGTATGGCTAGGTGAGCCTCAGCTCTAATAATTTGCTTAAACGTATGGTTAAACGTATGGAAACGTTAAACGTATGGTTCAAATTTAAACGTATGGCCCAACGGCTAAAGCCGGGGCAACGCTTGAGGAGAATTAAGGCTTAGATTACATTTCAGCGCGGACCCAGTAATTTCCCGCTGGCTGCACTGCTCTACGGCTAAAGCAGGGAATGAGGTTCTTGCACAATGCACTCCGTACGATGTCCAGCACGACATGTCGAAGATGACCAGACCAATACCGTTGTTCCGCCCCGAACGTCCGTAGACGACTTTAATCCTCCCACACCCCAACTAAGGAATACGGAGCTCCTCTACCCCACATCTTTCTGATACGTTCTCACCCAGCTTGAGGTCAATTCCCACCTATTTTGTTGATCGCCGCGCTGGTCACTCTTAGTAGGCTTCTGAACAACAGGTAAACCAAGTGGAGTCTGTACTATGACGTAGAGGAGATGCGCGCTCAGTAGAGGAGATGACGCGTAGAGGAGATGGGCAATTAACTAAAGGTGTAGAGGAGATGCATCTGGCGTAGAGGAGATGTGGCGTAGAGGAGATGTAGAGGAGATGGAGATGCGGGTGTAACACTTGACAGAGACTGACGGTAGAGGAGATGCTCCACGTAGAGGAGATGATCCTAGTGAGGTAAGTGTTAAGTAGAGGAGATGAAGCGCGGTAGAGGAGATGGGCCTGACTGGGAACGTAGAGGAGATGACGTAGTAGAGGAGATGAGAGGAGATGTAGAGGAGATGAGTAGAGGAGATGTGAGCGCCCCCAGAAGGCTTGGTATTGGCCCGACTTTGGAGTGATACGCGAGGTTTTTCTGCCCCCATGACTCGTGTAGAGGAGATGGGCACATGTAGAGGAGATGTGCGATCCGCATGTAAGGAGGGAGAGTAGAGGGTAGAGGAGATGTTGTGGTTCTGTGGTAGAGGAGTAGAGGAGATGAAGACAGTCGAGTAGGTAGAGGAGGTAGAGGAGATGGGTCTAAGAAATGACCGAAAGCCGCAGGATCCCCGCATCGCATCGCCGTAGCGTAAATACCACCTGGAACTGAACGTTGTAGACAACTGCATCTAATGTAGACGAGCTGACTGGAATACTGTTTTGTTGTGCATGTAACTGACGACAGAGCCCACAACAACCAATACTTTGAGCTTGTTCGAACCCCCATAGGGAACATCCTTGATTCTGTAGACTGGAATCCTATAGAACTTGTTAAAGCGACTACATCGGACATCCTTTGCGGAGCACGTAGATCTTTAGATCTTGGATGAATAGATGCCAAACGATTCCCCTCAGGGCTAATAGTTAAATCGGTCGAGGGGCCTCGAGTTATTGTGGTCCGGCACATGTTCAGCATGATTCGACTCCTGTGGGATTGGAACTCGGGAAAGGCGACGAATTTGCGTGTTAACTACAACACAAATTATCGGAGAATCCTATAGCGCAAACTTGCTCATATTGAGTTTTAGTATGCGTCTCATACCCTACCGAAGCGGCTGATATGGCCAGCCGCGCCCACTGCAGGGGGTGCTTATACTGCCGAGATGAAAGGAGTACATCAATCTGTGTAGGACAGCGAAGTGCTCCAAAGACTAGGGCGCCTAGCACGTGAGTCACTTCACTCTGTTTCAGACTCGCTTGCCTCCATAGTTGTTACACGCCGCACGCAAACCCTTTAAGGCAAACATCACGCAAAGAGCGAGGATTCTAGATCTGGGTACTATCTTGGAACACCGTGTGGCCTCTGAAGCCTTGATGGAGACGTGGTAGCTACTACCCATGTAGGTCACGTCTGGGGGGAATCTCAGACAATCTCAATTATTTCAATCCCCAAGCACACCCGGAGTAGACCATCTTTTAACCTGCCGTCGGGCCAGCCGGGAGAGATTAGATTTGGTAGAATGTCGAATGCCGACCTTGGGTCCGTTAAGCACTTAACGCGAAAGCATCCGAAAAGGGACCGAAGATAGGTCCTCCATCATATACAACAACAAAATGGTGTCAGACTGGAACCAGTCCTTTTGGCGAGTCTGATGCTAAAAACCTATGTGCCAAGGCTTTTTTTCCGAACGGGAATTAGAGCTGGTACACCGGGAAAAAAACTCTACATAAGCGAATATGGCCGCACCAGATGAAATGTGGGCTCTCCGGATGCCCGAGGAAGAAATCGATAAGCGCGACGAAGTTCTTGCCGTCCGCGCGGGGTAGCTATCGGGATTACTCAAACGAGCGCTTAGGACAAATGGGCCTCGGAATGCCTAGCAGGTCCTCGGACTATGGGGACTACTGATTTAACCGCCTGGCGATGGGGTCATATAAACCTCGTAAAAGGAATCCATGATGGGTCCCCAATATAGGGAACATAGCTCATGGACACATTGGCGAATTCTTAGGGGACGGGAAACTTATGCGGTACGCTGACCAGCGTTAGAGATGTAACACCATTCCTCTAGCCAGTTTCGTTATGCTATCTTGACGTGTTATACGTGAAAATTTAAGTGAGGTCGGGCGATCCTAGCCAGTTTCTAGCCAGTTTCCGGGATATCTACCGTGCGCCTAGCCAGTTTCTAGCCTAGCCAGTTTCCTCTAACTAGCCAGTTTCGAGGGCTGGGGCGGCAATGCAATATCTCGACGGGTAGTTGATGCCCCGAAAAGGGTGGCGAAGCAGCAATGCAATATCGCAATGCAATATATGCAATGCAATATTTTCTGCTAGGCAATGCAATATAGCCAGTTTCGCAATGCAATATCTAGCCAGTTTCATAATTCTCGGCTAGCCAGTTGCAATGCAATATCCGTGGCTGCCGAAACTCTCTATTGTGCGCGCAATGCAATATTGCAATATGACTAGGCAATGCAATATGCAATGCAATATCAATGCAATATCTCATGCTAGCCAGCTAGCCAGGCAATGCAATATCTAGCAATGCAATATTATAATATCCACGCACTAGCCAGTTTCAGCCTCCAAGCAATGCAATATTTTCTGCAATGCGCAATGCAATATTCAATGCAATATCCGTATACTCTAGCCAGTTTCGCAATGCAATATACGAACGCAATGCAATATGGCAATGCAATATGCAGCAATGCAATATATATGACTAAACGCAATGCAATATTTCATAGTAGCTCTTCAACCTCGGTGGGAGACAAGTACTCAATCCTCAACAACTTGTTGCAACTAATATATTGGGTACCCTCTTAGATCTAGCTTCTAACACCCCCCCAGAAAGGTCCACTCCAGATAGGGCATATTGCGACCACGATCCATGATCTAACCTGTCAGAGAATCCACGCTGACCATAGCTTACGTACGTCCTCACGGGGGGTTCCTCACGGGGGGAACAATGCTAGGCGACTCTAAGATCGCTATCAGTATCCTCACGGGGGATGTCCTCACGGGGGTTCCTTCCTCACGGGGGGTCTTCCTCACGGGGGTGGCATGGAAGTAACCTCCTCCTCACGGGGGCACGGGGGACTATATGCCCTTCACGACAGCTCCTCACGGGGGTTCGAGGCTCGCCTGTGTCCTCACGGGGGATCCTCACGGGGGGCAAGGGCGGGTCCTCACGGGGGTCCAAAGTATCCTCACGGGGGCTTCCTCACGGGGGTAGGTGGTCCTCACGGGGGTCCTCACGGGGGACGGGGGGCAGGAGCACTTTTCCTCACGGGGGTGTCACGATATTCGAGGCTCCTCACGGGGGAATCACTGCATCACAATCTCAACTATCAACGGAAGCCGACTCCTCACGGGGGGCATCTATTTCCTCACGGGGGTGGGCGGATCCTCACTCCTCACGGGGGTCTAGCTCGATACGCAGGCAGTATTAACCAGTATGGCTTATCCTCACGGGGGATTAACCAGTATATTAACCAGTATCAGTATGGTCCACGCGCGAATTAACCAGTATGTGATTAACCAATTAACCATTAACCAGTATTTAACCAGTATGGCCAGACTCACTAATCATCAGGCCTATTATACGCAGGAAGGGAAGGGCCGTGGGAACCGGGAGACCGTCCCGCAGGAAATCCGATCCGCAGCTCACTTTTCGACTTACATTATTAACCAGTATAGTATTCCCAATTAACCAGTATATTAACCAGTATTCCAACCGCGACGTCGAAGGCGAACACCCCCCGTCAACCTTCTCCCAACCGCGACGCACATTAACCAGTATGGATTAACCAGTATTATTATATTAACCAGTATACATTAACCAGTATGCGATTAACCAGTATATTAACCAGTATCGACAAGATCGGCCAACATTAACATTAACCAGTATTATCCAACCGCGAAATTAACCAGTATTAACCAGTATCCGCGACGCCGGTATTCGGATTTTGAGGCCATTAACCAGTATAGATTAACCAGTATATACCAACCGCCAATTAACCAGTATACCAACCGCGACGAGCCCAACCGCGACGCGCGCCCAACCGCGACGACGTCCGGCGGTATGCGCAAAAAACCAACCGCGACGAGAAGAGTCTGGCCAACCGCGACGACTGTGGACAGAACGACCAACCGCGACGCCGCGACGTCGGTGGTCGAGAACCAACCGCGACGCGCGACGCTCTCTAGCGATAAATACCCTCAAGTGTCCCCAACCGCGACGACGGCCTATAGGTAGCGCCTTCGGCCAACCGCGACGGGGTAAACCAACCGCGACGGGTTGCGGGCTAAAGCTTCTGTAGTTACACACCGCTCTATCTCTATGCAGTGACAAGTAGCTCGGTACTGCCTTTGGCGTGGGATCGCTTGAGGTCTGAGCCGAACTACTTTTGAAATGTGCTCCGTCATACTGGGACACCATATCCGTGGATACGGCTTCCGAGTTAGCCGACGATGACTCGCATCAAGCTCTTCGCTGTTGAGGAGGGCGAAACTTGCAG'
    pat_length = 12
    wind_length = 484
    appearance= 17
    a = find_clump(genome_string, pat_length, wind_length, appearance)
    #print str(a) checking to see if it's sorted 
    f.write(' '.join(a))


def PatternToNumber(Pattern):
    total = 0 
    nucleotide_to_number = {'A':0, 'C':1, 'G':2, 'T':3}
    for i in range(len(Pattern)):
        total = total * 4 + nucleotide_to_number[Pattern[i]]
    return total

def NumberToPattern(num_position, seq_length):
    nuc_conversion = {0:'A', 1:'C', 2:'G', 3:'T'}
    if seq_length == 0: 
        return None
    elif seq_length == 1: 
        return nuc_conversion[num_position%4]
    next_value = num_position // 4 #1359 
    remainder = nuc_conversion[num_position%4]
    return NumberToPattern(next_value, seq_length-1) + remainder

def FrequentWords(Text, k):
    FrequencyArray = [0 for i in range((4**k))] 

    for i in range(0, len(Text)-k+1):
        pattern = Text[i:k+i]
        j = PatternToNumber(pattern)
        #print pattern #confirmation that everything was being taken into account 
        FrequencyArray[j] = FrequencyArray[j] + 1
        
    return FrequencyArray


def find_clump(genome, k, L, t):
    FrequentPat = set()
    Clump = [0] * (4**k - 1)
    for i in range(0, len(genome)-L):
        Text = genome[i:i+L]
        FrequencyArray = FrequentWords(Text, k)
        for index in range(0, 4**k - 1):
            if FrequencyArray[index] >= t:
                Clump[index] = 1 
    for i in range(0, 4**k - 1):
        if Clump[i] == 1: 
            Pattern = NumberToPattern(i,k)
            FrequentPat.add(Pattern)
    return sorted(FrequentPat)

if __name__ == "__main__":
    f = open('ans.txt', 'w')
    main()
    f.close()